<ol class="breadcrumb">
  <li><a href="/groups">Groups</a></li>
  <li>
    <a href="/groups/<%=@group.slug%>"><%=@group.slug%></a>    
  </li>
  <li class="active">
    Stats
  </li>
</ol>

<table class="table">

  <%{'Most conversations started' => @c, 'Most posts' => @cp, 'Most events created' => @e}.each { |h2,hash| %>

    <tr>
      <td colspan="2">
        <h2><%=h2%></h2>
      </td>
    </tr>

    <% max = nil; hash.sort_by { |k,v| v.length }.reverse[0..9].each_with_index { |(k, v), i| if i == 0; max = v.length.to_f; end; k = Account.find(k) %>
      <tr>
        <td style="width: 170px">
          <div class="media">
            <span class="pull-left" >      
              <a href="/accounts/<%=k.id%>">
                <img class="media-object" style="width: 32px" src="<%=k.picture ? k.picture.thumb('32x32#').url : '/images/silhouette.png' %>">
              </a>
            </span>
            <div class="media-body">    
              <a href="/accounts/<%=k.id%>"><%=k.name%></a>
            </div>
          </div>           
        </td>
        <td>
          <div class="progress">
            <div class="progress-bar" role="progressbar" style="width:<%="#{100*(begin; v.length/max; rescue; raise "#{h2} - #{k.name} - #{v.length} - #{max}"; end)}%"%>">
              <%=v.length%>
            </div>
          </div>        
        </td>
      </tr>
    <% } %>

  <% } %>

</table>
