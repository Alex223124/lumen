<ul class="page-options">  
  <li>        
    <a class="edit" href="/groups/<%=@group.slug%>/lists/<%=@list.id%>/edit">
      <i class="fa fa-pencil"></i> Edit
    </a>
  </li> 
</ul>

<ol class="breadcrumb">
  <li><a href="/groups">Groups</a></li>
  <li>
    <a href="/groups/<%=@group.slug%>"><%=@group.slug%></a>    
  </li>
  <li>
    <a href="/groups/<%=@group.slug%>/lists">Lists</a>    
  </li>  
  <li>
    <%= @list.title %>
  </li>      
</ol>

<div class="row">
  <div class="<% if map = @list.list_items.any?(&:coordinates) %>col-md-4<% else %>col-md-8<% end %>">

    <h1>
      <%=@list.title%> <small><%=pluralize(@list.list_items.count, 'item')%></small>
      <a style="float: right" title="Download" class="btn btn-default" href="/groups/<%=@group.slug%>/lists/<%=@list.id%>.csv"><i class="fa fa-download"></i></a>
    </h1>

    <style>
      .list-item-li, .list-item-h2 { font-size: <% if map %>16<% else %>20<% end %>px !important }
    </style>
    <ol>
      <% @list.list_items_sorted.each { |list_item| %>
        <li class="list-item-li">
          <span style="float: right">
            <% if @list.order == 'score' %>
              <a class="edit" href="/groups/<%=@group.slug%>/lists/<%=@list.id%>/vote/<%=list_item.id%>/1"><i class="fa fa-chevron-up"></i></a>
              <%=list_item.score%>
              <a class="edit" href="/groups/<%=@group.slug%>/lists/<%=@list.id%>/vote/<%=list_item.id%>/-1"><i class="fa fa-chevron-down"></i></a>      
            <% end %>
            <a class="edit" href="/groups/<%=@group.slug%>/lists/<%=@list.id%>/edit/<%=list_item.id%>"><i class="fa fa-pencil"></i></a>
            <a class="edit" href="/groups/<%=@group.slug%>/lists/<%=@list.id%>/destroy/<%=list_item.id%>" data-confirm="Are you sure you want to remove this item?"><i class="fa fa-times"></i></a>            
          </span>            
          <h2 style="display:inline; line-height: 100%" class="list-item-h2">
            <% if list_item.link %>
              <a href="<%=list_item.link%>"><%=list_item.title%></a>
            <% else %>
              <%=list_item.title%>
            <% end %>
          <% if list_item.address %>
            <small style="font-size: 80%"><i class="fa fa-map-marker"></i> <%=list_item.address%></small>
          <% end %>              
          </h2>       
          <p style="font-size: 14px"><% if list_item.content%><%=list_item.content.gsub("\n","<br />\n")%><% end %></p>
        </li>
      <% } %>
    </ol>

  </div>
  <% if map %>
    <div class="col-md-4">    
      <div style="margin-top: 30px">
        <iframe style="height: 70vh" class="map" src="/groups/<%=@group.slug%>/lists/<%=@list.id%>/map"></iframe>
      </div>
    </div>
  <% end %>
  <div class="col-md-4">
    <h2>Add an item to this list</h2>
    <div id="add-single">
      <p><a href="javascript:;" onclick="$('#add-single').hide();
          $('#add-multiple').show();">Add multiple</a></p>    
        <% form_tag "/groups/#{@group.slug}/lists/#{@list.id}/add", :method => 'post' do %>
        <div class="form-group">
          <%= text_field_tag :title, :class => 'form-control', :placeholder => 'Title' %>
        </div>    
        <div class="form-group">
          <%= text_field_tag :link, :class => 'form-control', :placeholder => 'Link (optional)' %>
        </div>    
        <div class="form-group">
          <%= text_field_tag :address, :class => 'form-control', :placeholder => 'Address (if you want this item displayed on a map; optional)' %>
        </div>       
        <div class="form-group">
          <%= text_area_tag :content, :class => 'form-control', :placeholder => 'Content (optional)' %>
        </div>
        <button type="submit" class="btn btn-default">Add item</button>
      <% end %>
    </div>
    <div id="add-multiple" style="display: none">
      <p>Paste from spreadsheet, four columns: title, link, address, content</p>
      <% form_tag "/groups/#{@group.slug}/lists/#{@list.id}/add", :method => 'post' do %>
        <div class="form-group">
          <%= text_area_tag :data, :class => 'form-control' %>
        </div>    
        <button type="submit" class="btn btn-default">Add</button>
      <% end %>    
    </div> 

  </div>
</div>
