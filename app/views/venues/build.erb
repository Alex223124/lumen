<% if !@group %>
  <div class="row" style="margin-top: 10px">
    <div class="col-md-8 col-md-offset-2">
      <% form_tag '', :class => 'form-horizontal' do %>
        <div class="form-group">
          <label class="control-label col-md-3">Pick a group</label>
          <div class="col-md-6"> 
            <%=select_tag :slugs, :options => [''] + current_account.memberships.map(&:group).map(&:slug), :class => 'form-control', :onchange => "location = '/groups/' + $(this).val() + '/venues/new'" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
<% else %>

  <ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/groups"><%=I18n.t(:groups).capitalize%></a></li>
    <li>
      <a href="/groups/<%=@group.slug%>"><%=@group.slug%></a>    
    </li>
    <li>
      <a href="/groups/<%=@group.slug%>/venues">Venues</a>    
    </li>  
    <% if @venue.persisted? %>
      <li>
        <a href="/groups/<%=@group.slug%>/venues/<%=@venue.id%>"><%= @venue.name %></a>    
      </li>      
      <li class="active">
        Edit
      </li>
    <% else %>
      <li class="active">
        Add venue
      </li>    
    <% end %>
  </ol>


  <div class="row" style="margin-top: 10px">
    <div class="col-md-8 col-md-offset-2">

      <% form_for @venue, @venue.new_record? ? "/groups/#{@group.slug}/venues/new" : "/groups/#{@group.slug}/venues/#{@venue.id}/edit", :class => 'form-horizontal', :multipart => true do |f| %>


        <script>
          $(function () {
    <% if @venue.new_record? %>
              $('#venue_address').keyup(function () {
                if ($(this).val().length > 0)
                  $('label[for=venue_coordinates]').parent().hide()
                else
                  $('label[for=venue_coordinates]').parent().show()
              }).keyup();              
    <% end %>

            var inputGroup = $('<div class="input-group"></div>');
            $('#venue_hourly_cost').wrap(inputGroup);
            $('<span class="input-group-addon">Â£</span>').prependTo($('#venue_hourly_cost').parent());
          });
        </script>

        <%= f.text_block :name %>
        <%= f.number_block :capacity %>
        <%= f.select_block :accessibility %>
        <%= f.check_box_block :private %>
        <%= f.check_box_block :serves_food %>
        <%= f.check_box_block :serves_alcohol %>
        <%= f.number_block :hourly_cost %>
        <%= f.text_block :website %>        
        <%= f.text_block :address, :tip => "If you don't know the exact address, leave this blank and click to place a marker on the map below" %>
        <%= f.geopicker_block :coordinates %>
        <%= f.wysiwyg_block :description %>      

        <%= f.submit_block destroy_url: "/groups/#{@group.slug}/venues/#{@venue.id}/destroy" %>

      <% end %>

    </div>
  </div>

<% end %>